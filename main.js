!function(){"use strict";function t(t){const e="Field must be filled",i="Price must be a number",s="Price must be more than zero";let o=null,n=null;const r=t.name.trim(),p=Number(t.price.trim());if(0===r.length)o="Field must be filled",n="name";else if(0===p.length)o=e,n="price";else if("number"!=typeof p||Number.isNaN(p))o=i,n="price";else{if(!(p<=0))return!1;o=s,n="price"}return{text:o,place:n}}class e{constructor(){this.products=document.querySelector(".products")}static createHTML(t){return`\n      <li class="product" data-id="${t.id}">\n        <div class="name">${t.name}</div>\n        <div class="price">${t.price}</div>\n        <div class="tools">\n          <span class="update">✎</span>\n          <span class="delete">✕</span>\n        </div>\n      </li>\n    `}static clearDOM(){document.querySelectorAll(".product").forEach((t=>t.remove()))}addToDOM(t){const i=e.createHTML(t);this.products.insertAdjacentHTML("beforeend",i)}}class i{constructor(){this.memory=[],this.renderer=new e}findProduct(t){return this.memory.find((e=>e.id===Number(t)))}add(t){this.memory.push(t),this.render()}remove(t){const e=this.memory.findIndex((e=>e.id===t));this.memory.splice(e,1),this.render()}replace(t){const e=this.memory.findIndex((e=>e.id===t.id));this.memory.splice(e,1,t),this.render()}render(){e.clearDOM(),this.memory.forEach((t=>this.renderer.addToDOM(t)))}}class s{constructor(){this.tooltips=[]}showTooltip(t,e){const i=document.createElement("div");i.classList.add("tooltip"),i.textContent=t;const s=performance.now();this.tooltips.push({id:s,element:i});const{bottom:o,left:n}=e.getBoundingClientRect();i.top=`${o+10}px`,document.querySelector(".popup").appendChild(i)}}new class{constructor(t){this.element=t,this.memory=new i,this.showBtn=this.element.querySelector(".create"),this.popup=this.element.querySelector(".popup"),this.onClick=this.onClick.bind(this),this.onSubmit=this.onSubmit.bind(this),this.element.addEventListener("click",this.onClick),this.popup.addEventListener("submit",this.onSubmit)}onClick(t){if(t.target.classList.contains("cancel-button")||t.target.classList.contains("create"))return this.popup.classList.remove("being-edited"),this.togglePopup(),void this.popup.reset();const e=t.target.closest(".product");if(!e)return;const i=e.getAttribute("data-id"),s=this.memory.findProduct(i),{id:o,name:n,price:r}=s;t.target.classList.contains("delete")?this.memory.remove(o):t.target.classList.contains("update")&&(this.popup.classList.add("being-edited"),this.togglePopup(),this.popup.name.value=n,this.popup.price.value=r,this.popup.setAttribute("id",o))}onSubmit(e){e.preventDefault();const i={id:performance.now(),name:this.popup.name.value,price:this.popup.price.value};if(t(i)){const{text:e,place:s}=t(i);this.showTooltip(e,this.popup[s])}else this.popup.classList.contains("being-edited")?(i.id=Number(this.popup.getAttribute("id")),this.memory.replace(i),this.popup.reset(),this.popup.classList.remove("being-edited")):this.memory.add(i),this.popup.reset(),this.togglePopup()}showTooltip(t,e){this.tooltipFactory=new s,this.tooltipFactory.showTooltip(t,e)}togglePopup(){this.popup.classList.toggle("hidden")}}(document.querySelector(".application"))}();
//# sourceMappingURL=main.js.map